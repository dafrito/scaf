# This must always contain a package-specific subdirectory
PKGDATADIR=${DATADIR}/scaf

APP=scaf

all: ${APP}
.PHONY: all

Makefile: Makefile.in configure
	./configure ${PREFIX}

${APP}: run.sh
	echo "#!/bin/bash"                                >$@-wip
	echo "# Autogenerated this executable at `date`" >>$@-wip
	echo "# DO NOT EDIT THIS FILE!"                  >>$@-wip
	echo                                             >>$@-wip
	echo "SCAF_INSTALLED=true"                       >>$@-wip
	echo "SCAF=${BINDIR}/scaf"                       >>$@-wip
	echo "SCAFDIR=${PKGDATADIR}"                     >>$@-wip
	echo                                             >>$@-wip
	tail -n +2 $^                                    >>$@-wip
	#
	chmod +x $@-wip
	chmod ugo-w $@-wip
	rm -f $@
	mv $@-wip $@

${BINDIR} ${PKGDATADIR}:
	mkdir -p $@
